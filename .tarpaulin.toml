# Tarpaulin configuration for code coverage
[report]
out = ["Html", "Lcov", "Json"]
output-dir = "./coverage"

[run]
# Increase timeout to 10 minutes (default is 5 minutes)
timeout = 600

# Run tests single-threaded to avoid race conditions under instrumentation
implicit-test-threads = 1

# Exclude files and directories
exclude-files = [
    "riglr-showcase/*",
    "create-riglr-app/*",
    "target/*",
    "*/tests/*",  # Optionally exclude all test files from coverage metrics
    "*/benches/*"
]

[coverage]
# Skip specific slow or problematic tests
# Use test name patterns to exclude
skip-tests = [
    "test_tool_worker_process_job_timeout",  # Has 60-second timeout
    "test_queue_stress_test",                # Heavy concurrent operations
    "test_concurrent_*",                     # All concurrent stress tests
    "*redis*"                                # Skip Redis tests if Redis not available
]

# Additional cargo test arguments
args = ["--lib", "--bins"]  # Focus on library and binary code, not integration tests